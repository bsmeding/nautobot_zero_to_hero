# Bootstrap configuration for workstation1 (Alpine Linux)
# Workstation for network testing and demonstrations

# Configure management interface (eth0)
cat > /etc/network/interfaces << EOF
auto lo
iface lo inet loopback

auto eth0
iface eth0 inet static
    address 172.20.20.15
    netmask 255.255.255.0
    gateway 172.20.20.1

auto eth1
iface eth1 inet static
    address 10.0.0.15
    netmask 255.255.255.0
EOF

# Install network testing tools
apk add --no-cache openssh iproute2 ethtool curl iputils bash tcpdump iperf3 mtr

# Set root password
echo "root:admin" | chpasswd

# Enable SSH with root login and password authentication
ssh-keygen -A
sed -i 's/^#PermitRootLogin.*/PermitRootLogin yes/' /etc/ssh/sshd_config
sed -i 's/^#PasswordAuthentication.*/PasswordAuthentication yes/' /etc/ssh/sshd_config
echo "PermitRootLogin yes" >> /etc/ssh/sshd_config
echo "PasswordAuthentication yes" >> /etc/ssh/sshd_config
rc-update add sshd default

# Create workspace directory
mkdir -p /home/workspace

# Add lab devices to /etc/hosts for easy access
cat >> /etc/hosts << HOSTS_EOF
# Lab devices
172.20.20.11    access1.lab access1
172.20.20.12    access2.lab access2
172.20.20.13    dist1.lab dist1
172.20.20.14    rtr1.lab rtr1
172.20.20.15    workstation1.lab workstation1
172.20.20.16    mgmt.lab mgmt management
HOSTS_EOF

# Set up basic logging
echo "Workstation1 initialized at $(date)" > /var/log/workstation.log

# Enable network interfaces
ifup eth0
ifup eth1

echo "Workstation1 bootstrap completed - Ready for network automation demos"

# Start SSH daemon (must be last command)
/usr/sbin/sshd -D

